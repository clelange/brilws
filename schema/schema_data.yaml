#
# Schema for IOV data
#

DATATABLEMAP: #static map , data table registry
   columns:
    - datasourceid: unsigned short
    - basetablename: string
    - tablesuffix: string
    - datasourcename: string      #deadtime,beamstatus,runinfo,fillinfo,trg,hlt,beamintensity,bcm1flumi,hfoclumi,hfetlumi,pltlumi,pixellumi,bhmbkg,hfoclumiresult,pixellumiresult
    - minrun: unsigned int
    - maxrun: unsigned int
   pk: [datasourceid]

BEAMSTATUSMAP: #static map
   columns:
    - beamstatusid: unsigned short
    - beamstatus: string
   pk: [beamstatusid]
   
TRGBITMAP:
   columns:    #static map
    - bitnameid: unsigned short
    - bitid: unsigned short
    - bitname: string              #name used in l1seed expression
    - isalgo: bool
   pk: [bitnameid]


HLTPATHMAP:    #static map
   columns:
    - hltpathid: unsigned int
    - hltpathname: string
   pk: [hltpathid]

DATASETMAP:   #static map
   columns:
    - datasetid: unsigned int
    - datasetname: string
   pk: [datasetid]
   
HLTSTREAMDATASET:  #static map , hlt stream, dataset, path map           
   columns:
    - hltpathid: unsigned int
    - streamid: unsigned int
    - streamlabel: string
    - datasetid: unsigned int
   pk: [hltpathid,streamid,datasetid]

##### Data tables #####

DATATAGS:          
   columns:
    - datatagid: long long
    - datatagname: string
    - creationutc: string
    - comment: string
   pk: [datatagid]
   unique: [datatagname]

DATATAGCONTENT: #per ls , per data type
   columns:
    - datatagid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - datasourceid: unsigned short      #deadtime,beamstatusinfo,runinfo,fillinfo,trg,hlt,beamintensity,bcm1flumi,hfoclumi,hfetlumi,pltlumi,pixellumi,bhmbkg
    - dataid: long long
   pk: [runnum,lsnum,datatagid,datasourceid]
  

TIMEINDEX:      #per ls
   columns:
    - runnum: unsigned int
    - lsnum: unsigned int
    - cmslsnum: unsigned int
    - timestamp: long long
    - timestampstr: string       #just for display. do not query
    - weekofyear: unsigned short
    - dayofyear: unsigned short
    - year: unsigned short
    - monthofyear: unsigned short    
   pk: [runnum,lsnum]
  
FILLINFO:        #per fill
   columns:
    - dataid: long long
    - fillnum: unsigned int
    - amodetag: string
    - egev: unsigned int
    - fillscheme: string
    - ncollidingbx: unsigned short
    - beamconfig: blob
   pk: [dataid]

RUNINFO:          #per run
   columns:       
    - dataid: long long
    - runnum: unsigned int
    - hltconfigid: unsigned int
    - hltkey: string
    - l1seedexpression: string
    - gt_rs_key: string
   pk: [dataid]

BEAMSTATUSINFO:         #per ls
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - beamstatusid: unsigned short
   pk: [dataid]

BEAMINTENSITY_&suffix:  #per ls, per bx
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - bxidx: unsigned short
    - beam1intensity: unsigned int
    - beam2intensity: unsigned int
   pk: [dataid,bxidx]

HFOCLUMI_&suffix:       #per ls, per bx
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - bxidx: unsigned short
    - instlumi: float
   pk: [dataid,bxidx]

HFETLUMI_&suffix:       #per ls, per bx
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - bxidx: unsigned short
    - instlumi: float
   pk: [dataid,bxidx]

BCM1FLUMI_&suffix:       #per ls, per bx
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - bxidx: unsigned short
    - instlumi: float
   pk: [dataid,bxidx]

PLTLUMI_&suffix:          #per ls, per bx
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - bxidx: unsigned short
    - instlumi: float
   pk: [dataid,bxidx]

PIXELLUMI_&suffix:        #per ls, per bx
   columns:
    - dataid: long long
    - runnum: unsigned int
    - cmslsnum: unsigned int
    - bxidx: unsigned short
    - instlumi: float
   pk: [dataid,bxidx]

TRG_&suffix:               #per ls, per trg bit
   columns:
    - dataid: long long
    - runnum: unsigned int
    - cmslsnum: unsigned int
    - trgbitid: unsigned short
    - trgbitnameid: unsigned short
    - prescidx: unsigned short
    - prescval: unsigned int  
    - bitmask: unsigned char
    - counts: unsigned int
    - physicsdeclared: unsigned short
   pk: [dataid,trgbitnameid]

HLT_&suffix:  #per ls, per hltpath
   columns:
    - dataid: long long
    - hltpathid: unsigned int
    - runnum: unsigned int
    - cmslsnum: unsigned int
    - prescidx: unsigned short
    - prescval: unsigned int
    - l1pass: unsigned int
    - hltaccept: unsigned int
   pk: [dataid,hltpathid]
     
DEADTIME:       #per ls
   columns:
    - dataid: long long
    - runnum: unsigned int
    - lsnum: unsigned int
    - deadtimefrac: float
   pk: [dataid] 




